#!/usr/bin/env node

const express = require('express')
const http = require('http')
const path = require('path')

const app = express()
const httpServer = http.Server(app)

const argv = require('minimist')(process.argv.slice(2));
const port = argv.port || 3000
const serveFolder = argv.serveFolder
if (!serveFolder) {
  throw new Error('Mandatory parameter --serveFolder missing')
}

app.get('/:name/', function(req, res){
    res.sendFile(`${req.params.name}/index.json`, {root: path.resolve(argv.serveFolder)});
})

app.get('/:name/:file', function(req, res){
    res.sendFile(`${req.params.name}/${req.params.file}`, {root: path.resolve(argv.serveFolder)});
})

httpServer.listen(port, () => {
  console.log(`Listening on port *:${port}`)
})
